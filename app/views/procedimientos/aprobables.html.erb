<section>
  <div class="page-header">
    <h1>Procedimientos <small>Control de Cambios</small></h1>
  </div>

	<ul class="nav nav-tabs" id="myTab">
	  <li class="active">
	    <a href="#pendientes">Pendientes de Aprobación</a>
	  </li>
	  <li><a href="#aprobados">Aprobados</a></li>
	  <li><a href="#borradores">Borradores</a></li>
	</ul>

	<div class="tab-content">
	  <div class="tab-pane active" id="pendientes">
	  	<h4>Lista de Procedimientos Pendientes de Aprobación</h4>
	  	<% if @a_aprobar.present? %>
		  	<table class="table table-striped table-bordered table-condensed">
		  		<thead>
		  			<tr>
		  			  <th>Nombre</th>
		  				<th>Última modificación</th>
              <th></th>
		  			</tr>
		  		</thead>
		  		<tbody>
						<% @a_aprobar.each do |a_aprobar| %>
							<tr>
								<td><%= a_aprobar.nombre %></td>
								<td><%= l(a_aprobar.updated_at) %></td>
                <td><%= link_to 'Aprobar', aprobar_procedimiento_path(id: a_aprobar.id, tipo: aprobado.bloqueado?), :class => 'btn btn-primary' %></td>
							</tr>
		  			<% end %>
		  		</tbody>
		  	</table>		  	
	  	<% else %>
	  		<p class='alert alert-warning'>No hay registros</p>
	  	<% end %>	  	
	  </div>
	  <div class="tab-pane" id="aprobados">
	  	<h4>Lista de Procedimientos Aprobados</h4>
	  	<% if @aprobados.present? %>
		  	<table class="table table-striped table-bordered table-condensed">
		  		<thead>
		  			<tr>
		  				<th>Nombre</th>
              <th>Bloqueado</th>
              <th>Última modificación</th>
              <th></th>
            </tr>
		  		</thead>
		  		<tbody>
						<% @aprobados.each do |aprobado| %>
							<tr>
								<td><%= aprobado.nombre %></td>
                <td><%= si_no(aprobado.bloqueado) %></td>
								<td><%= l(aprobado.updated_at) %></td>
                <td>
                  <%= link_to 'Desbloquear', lock_procedimiento_path(id: aprobado.id, tipo: aprobado.bloqueado?), :class => 'btn btn-info' if aprobado.bloqueado? %>
                  <%= link_to 'Bloquear', "#", :class => 'btn btn-info',
                              confirm: '¿Está seguro?' unless aprobado.bloqueado? %>
                  <%= link_to 'Desaprobar', aprobar_procedimiento_path(id: aprobado.id, tipo: 'a'),
                              :class => 'btn btn-primary', confirm: '¿Está seguro?' %>
                </td>
							</tr>
		  			<% end %>
		  		</tbody>
		  	</table>		  	
	  	<% else %>
	  		<p class='alert alert-warning'>No hay registros</p>
	  	<% end %>	 
	  </div>
	  <div class="tab-pane" id="borradores">
      <h4>Lista de Procedimientos Aprobados</h4>
      <% if @borradores.present? %>
        <table class="table table-striped table-bordered table-condensed">
          <thead>
          <tr>
            <th>Nombre</th>
            <th>Última modificación</th>
          </tr>
          </thead>
          <tbody>
          <% @borradores.each do |borrador| %>
            <tr>
              <td><%= borrador.nombre %></td>
              <td><%= l(borrador.updated_at) %></td>
            </tr>
          <% end %>
          </tbody>
        </table>
      <% else %>
        <p class='alert alert-warning'>No hay registros</p>
      <% end %>
	  </div>
	</div>
</section>

<% content_for :javascripts do %>
<script type="text/javascript">
	$(function(){
		$('#myTab a').click(function (e) {
		  e.preventDefault();
		  $(this).tab('show');
		});
	})
</script>
<% end %>